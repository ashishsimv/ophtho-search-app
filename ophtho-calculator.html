<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ophthalmology Clinical Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .calculator-selector {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .calculator-selector h2 {
            margin-bottom: 15px;
            color: #333;
        }

        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .calc-btn {
            padding: 15px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .calc-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .calc-btn.active {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .calculator-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            display: none;
        }

        .calculator-card.active {
            display: block;
        }

        .calc-title {
            font-size: 1.8em;
            margin-bottom: 10px;
            color: #333;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .calc-description {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .calculate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 20px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .result-box {
            margin-top: 25px;
            padding: 20px;
            background: #f0f7ff;
            border-left: 5px solid #667eea;
            border-radius: 8px;
            display: none;
        }

        .result-box.show {
            display: block;
        }

        .result-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 2em;
            font-weight: 700;
            color: #333;
            margin: 15px 0;
        }

        .result-interpretation {
            color: #666;
            line-height: 1.6;
            margin-top: 10px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            color: #856404;
        }

        .reference {
            font-size: 0.9em;
            color: #999;
            margin-top: 20px;
            font-style: italic;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üëÅÔ∏è Ophthalmology Clinical Calculator</h1>
            <p>Evidence-based clinical calculations for eye care professionals</p>
        </div>

        <div class="calculator-selector">
            <h2>Select Calculator:</h2>
            <div class="calc-buttons">
                <button class="calc-btn active" onclick="showCalculator('iol')">IOL Power</button>
                <button class="calc-btn" onclick="showCalculator('cup-disc')">Cup-to-Disc Ratio</button>
                <button class="calc-btn" onclick="showCalculator('dr-risk')">DR Progression Risk</button>
                <button class="calc-btn" onclick="showCalculator('refraction')">Spherical Equivalent</button>
                <button class="calc-btn" onclick="showCalculator('iop')">Target IOP</button>
                <button class="calc-btn" onclick="showCalculator('ace')">ACE Score</button>
            </div>
        </div>

        <!-- IOL Power Calculator -->
        <div id="iol" class="calculator-card active">
            <h2 class="calc-title">IOL Power Calculator (SRK/T Formula)</h2>
            <p class="calc-description">Calculate the intraocular lens power for cataract surgery using the SRK/T formula.</p>
            
            <div class="form-group">
                <label>Axial Length (AL) in mm:</label>
                <input type="number" id="iol-al" step="0.01" placeholder="e.g., 23.45">
            </div>
            
            <div class="form-group">
                <label>Keratometry (K) Average in Diopters:</label>
                <input type="number" id="iol-k" step="0.01" placeholder="e.g., 44.00">
            </div>
            
            <div class="form-group">
                <label>A-Constant:</label>
                <input type="number" id="iol-a" step="0.1" value="118.5" placeholder="e.g., 118.5">
            </div>
            
            <div class="form-group">
                <label>Target Refraction (Diopters):</label>
                <input type="number" id="iol-target" step="0.25" value="0" placeholder="0 for emmetropia">
            </div>
            
            <button class="calculate-btn" onclick="calculateIOL()">Calculate IOL Power</button>
            
            <div id="iol-result" class="result-box">
                <div class="result-title">Recommended IOL Power</div>
                <div class="result-value" id="iol-value"></div>
                <div class="result-interpretation" id="iol-interpretation"></div>
            </div>
        </div>

        <!-- Cup-to-Disc Ratio -->
        <div id="cup-disc" class="calculator-card">
            <h2 class="calc-title">Cup-to-Disc Ratio Calculator</h2>
            <p class="calc-description">Calculate vertical and horizontal cup-to-disc ratios for glaucoma assessment.</p>
            
            <div class="grid-2">
                <div class="form-group">
                    <label>Vertical Cup Diameter (mm):</label>
                    <input type="number" id="v-cup" step="0.1" placeholder="e.g., 0.6">
                </div>
                
                <div class="form-group">
                    <label>Vertical Disc Diameter (mm):</label>
                    <input type="number" id="v-disc" step="0.1" placeholder="e.g., 1.5">
                </div>
            </div>
            
            <div class="grid-2">
                <div class="form-group">
                    <label>Horizontal Cup Diameter (mm):</label>
                    <input type="number" id="h-cup" step="0.1" placeholder="e.g., 0.5">
                </div>
                
                <div class="form-group">
                    <label>Horizontal Disc Diameter (mm):</label>
                    <input type="number" id="h-disc" step="0.1" placeholder="e.g., 1.5">
                </div>
            </div>
            
            <button class="calculate-btn" onclick="calculateCDR()">Calculate CDR</button>
            
            <div id="cdr-result" class="result-box">
                <div class="result-title">Cup-to-Disc Ratios</div>
                <div class="result-value" id="cdr-value"></div>
                <div class="result-interpretation" id="cdr-interpretation"></div>
            </div>
        </div>

        <!-- DR Risk Calculator -->
        <div id="dr-risk" class="calculator-card">
            <h2 class="calc-title">Diabetic Retinopathy Progression Risk</h2>
            <p class="calc-description">Estimate 4-year risk of DR progression based on ETDRS criteria.</p>
            
            <div class="form-group">
                <label>Current DR Severity:</label>
                <select id="dr-severity">
                    <option value="none">No DR</option>
                    <option value="mild">Mild NPDR</option>
                    <option value="moderate">Moderate NPDR</option>
                    <option value="severe">Severe NPDR</option>
                    <option value="pdr">PDR</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>HbA1c (%):</label>
                <input type="number" id="dr-hba1c" step="0.1" placeholder="e.g., 7.5">
            </div>
            
            <div class="form-group">
                <label>Duration of Diabetes (years):</label>
                <input type="number" id="dr-duration" step="1" placeholder="e.g., 10">
            </div>
            
            <div class="form-group">
                <label>Blood Pressure Control:</label>
                <select id="dr-bp">
                    <option value="good">Good (BP <140/90)</option>
                    <option value="moderate">Moderate (BP 140-159/90-99)</option>
                    <option value="poor">Poor (BP ‚â•160/100)</option>
                </select>
            </div>
            
            <button class="calculate-btn" onclick="calculateDRRisk()">Calculate Risk</button>
            
            <div id="dr-result" class="result-box">
                <div class="result-title">4-Year Progression Risk</div>
                <div class="result-value" id="dr-value"></div>
                <div class="result-interpretation" id="dr-interpretation"></div>
            </div>
        </div>

        <!-- Spherical Equivalent -->
        <div id="refraction" class="calculator-card">
            <h2 class="calc-title">Spherical Equivalent Calculator</h2>
            <p class="calc-description">Calculate spherical equivalent from sphere and cylinder values.</p>
            
            <div class="grid-2">
                <div class="form-group">
                    <label>Sphere (Diopters):</label>
                    <input type="number" id="ref-sphere" step="0.25" placeholder="e.g., -2.00">
                </div>
                
                <div class="form-group">
                    <label>Cylinder (Diopters):</label>
                    <input type="number" id="ref-cyl" step="0.25" placeholder="e.g., -1.50">
                </div>
            </div>
            
            <button class="calculate-btn" onclick="calculateSE()">Calculate Spherical Equivalent</button>
            
            <div id="se-result" class="result-box">
                <div class="result-title">Spherical Equivalent</div>
                <div class="result-value" id="se-value"></div>
                <div class="result-interpretation" id="se-interpretation"></div>
            </div>
        </div>

        <!-- Target IOP -->
        <div id="iop" class="calculator-card">
            <h2 class="calc-title">Target IOP Calculator</h2>
            <p class="calc-description">Calculate target intraocular pressure based on baseline IOP and glaucoma severity.</p>
            
            <div class="form-group">
                <label>Baseline IOP (mmHg):</label>
                <input type="number" id="iop-baseline" step="1" placeholder="e.g., 24">
            </div>
            
            <div class="form-group">
                <label>Glaucoma Severity:</label>
                <select id="iop-severity">
                    <option value="early">Early (MD better than -6 dB)</option>
                    <option value="moderate">Moderate (MD -6 to -12 dB)</option>
                    <option value="advanced">Advanced (MD worse than -12 dB)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Risk Factors:</label>
                <select id="iop-risk">
                    <option value="low">Low risk (stable, well-controlled)</option>
                    <option value="moderate">Moderate risk</option>
                    <option value="high">High risk (progression, family history)</option>
                </select>
            </div>
            
            <button class="calculate-btn" onclick="calculateTargetIOP()">Calculate Target IOP</button>
            
            <div id="target-iop-result" class="result-box">
                <div class="result-title">Target IOP Range</div>
                <div class="result-value" id="target-iop-value"></div>
                <div class="result-interpretation" id="target-iop-interpretation"></div>
            </div>
        </div>

        <!-- ACE Score -->
        <div id="ace" class="calculator-card">
            <h2 class="calc-title">ACE (Age-related Eye Disease Study) Risk Score</h2>
            <p class="calc-description">Estimate 5-year risk of progression to advanced AMD.</p>
            
            <div class="form-group">
                <label>Age:</label>
                <input type="number" id="ace-age" step="1" placeholder="e.g., 70">
            </div>
            
            <div class="form-group">
                <label>Drusen Size (worse eye):</label>
                <select id="ace-drusen">
                    <option value="none">No drusen or small drusen</option>
                    <option value="medium">Medium drusen</option>
                    <option value="large">Large drusen</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Pigment Abnormalities:</label>
                <select id="ace-pigment">
                    <option value="none">None</option>
                    <option value="present">Present</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Advanced AMD in Fellow Eye:</label>
                <select id="ace-fellow">
                    <option value="no">No</option>
                    <option value="yes">Yes</option>
                </select>
            </div>
            
            <button class="calculate-btn" onclick="calculateACE()">Calculate AMD Risk</button>
            
            <div id="ace-result" class="result-box">
                <div class="result-title">5-Year Risk of Advanced AMD</div>
                <div class="result-value" id="ace-value"></div>
                <div class="result-interpretation" id="ace-interpretation"></div>
            </div>
        </div>

    </div>

    <script>
        function showCalculator(calcId) {
            // Hide all calculators
            document.querySelectorAll('.calculator-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Remove active from all buttons
            document.querySelectorAll('.calc-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected calculator
            document.getElementById(calcId).classList.add('active');
            
            // Highlight active button
            event.target.classList.add('active');
        }

        function calculateIOL() {
            const al = parseFloat(document.getElementById('iol-al').value);
            const k = parseFloat(document.getElementById('iol-k').value);
            const a = parseFloat(document.getElementById('iol-a').value);
            const target = parseFloat(document.getElementById('iol-target').value);
            
            if (!al || !k || !a) {
                alert('Please fill in all required fields');
                return;
            }
            
            // SRK/T Formula (simplified)
            const lOpt = a - 2.5 * al - 0.9 * k;
            const rOpt = (lOpt > 0) ? lOpt / al : lOpt;
            const cOpt = rOpt + 0.1;
            const acd = 0.62467 * a - 68.747;
            
            // Calculate IOL power
            const iolPower = (1336 / (al - cOpt - acd)) - (1.336 / ((1.336 / (k + target)) - cOpt - acd));
            
            const resultBox = document.getElementById('iol-result');
            const resultValue = document.getElementById('iol-value');
            const resultInterpretation = document.getElementById('iol-interpretation');
            
            resultValue.textContent = iolPower.toFixed(2) + ' D';
            
            let interpretation = `Recommended IOL power for target refraction of ${target.toFixed(2)}D.<br><br>`;
            interpretation += `<strong>Input Parameters:</strong><br>`;
            interpretation += `‚Ä¢ Axial Length: ${al.toFixed(2)} mm<br>`;
            interpretation += `‚Ä¢ Average K: ${k.toFixed(2)} D<br>`;
            interpretation += `‚Ä¢ A-Constant: ${a.toFixed(1)}<br><br>`;
            interpretation += `<strong>Note:</strong> This is a simplified SRK/T calculation. For actual surgical planning, use dedicated biometry equipment and consider surgeon-specific factors.`;
            
            resultInterpretation.innerHTML = interpretation;
            resultBox.classList.add('show');
        }

        function calculateCDR() {
            const vCup = parseFloat(document.getElementById('v-cup').value);
            const vDisc = parseFloat(document.getElementById('v-disc').value);
            const hCup = parseFloat(document.getElementById('h-cup').value);
            const hDisc = parseFloat(document.getElementById('h-disc').value);
            
            if (!vCup || !vDisc || !hCup || !hDisc) {
                alert('Please fill in all fields');
                return;
            }
            
            const vCDR = vCup / vDisc;
            const hCDR = hCup / hDisc;
            
            const resultBox = document.getElementById('cdr-result');
            const resultValue = document.getElementById('cdr-value');
            const resultInterpretation = document.getElementById('cdr-interpretation');
            
            resultValue.innerHTML = `Vertical: ${vCDR.toFixed(2)}<br>Horizontal: ${hCDR.toFixed(2)}`;
            
            let interpretation = '';
            let warning = '';
            
            if (vCDR <= 0.3) {
                interpretation = '<strong>Normal:</strong> Cup-to-disc ratio within normal limits.';
            } else if (vCDR <= 0.5) {
                interpretation = '<strong>Borderline:</strong> Slightly enlarged cup. Monitor for glaucoma.';
                warning = 'Consider baseline visual field and OCT for glaucoma screening.';
            } else if (vCDR <= 0.7) {
                interpretation = '<strong>Abnormal:</strong> Enlarged cup suspicious for glaucoma.';
                warning = 'Recommend comprehensive glaucoma workup including IOP, visual fields, and OCT.';
            } else {
                interpretation = '<strong>Highly Abnormal:</strong> Significantly enlarged cup, highly suspicious for glaucoma.';
                warning = 'Urgent glaucoma evaluation recommended.';
            }
            
            interpretation += `<br><br><strong>Interpretation:</strong><br>`;
            interpretation += `‚Ä¢ Normal CDR: <0.3<br>`;
            interpretation += `‚Ä¢ Borderline: 0.3-0.5<br>`;
            interpretation += `‚Ä¢ Abnormal: 0.5-0.7<br>`;
            interpretation += `‚Ä¢ Highly abnormal: >0.7`;
            
            if (warning) {
                interpretation += `<div class="warning-box"><strong>‚ö†Ô∏è Clinical Note:</strong><br>${warning}</div>`;
            }
            
            resultInterpretation.innerHTML = interpretation;
            resultBox.classList.add('show');
        }

        function calculateDRRisk() {
            const severity = document.getElementById('dr-severity').value;
            const hba1c = parseFloat(document.getElementById('dr-hba1c').value);
            const duration = parseFloat(document.getElementById('dr-duration').value);
            const bp = document.getElementById('dr-bp').value;
            
            if (!severity || !hba1c || !duration || !bp) {
                alert('Please fill in all fields');
                return;
            }
            
            // Risk calculation based on severity and risk factors
            let baseRisk = 0;
            switch(severity) {
                case 'none': baseRisk = 5; break;
                case 'mild': baseRisk = 15; break;
                case 'moderate': baseRisk = 35; break;
                case 'severe': baseRisk = 55; break;
                case 'pdr': baseRisk = 75; break;
            }
            
            // HbA1c modifier (each 1% above 7 adds ~10% risk)
            if (hba1c > 7) {
                baseRisk += (hba1c - 7) * 10;
            }
            
            // Duration modifier (each 5 years adds ~5% risk)
            baseRisk += (duration / 5) * 5;
            
            // BP modifier
            if (bp === 'moderate') baseRisk += 5;
            if (bp === 'poor') baseRisk += 15;
            
            // Cap at 95%
            const totalRisk = Math.min(baseRisk, 95);
            
            const resultBox = document.getElementById('dr-result');
            const resultValue = document.getElementById('dr-value');
            const resultInterpretation = document.getElementById('dr-interpretation');
            
            resultValue.textContent = totalRisk.toFixed(0) + '%';
            
            let interpretation = '';
            let riskLevel = '';
            
            if (totalRisk < 20) {
                riskLevel = 'Low Risk';
                interpretation = 'Annual dilated eye exam recommended.';
            } else if (totalRisk < 40) {
                riskLevel = 'Moderate Risk';
                interpretation = 'Eye exam every 6-12 months. Optimize glycemic and BP control.';
            } else if (totalRisk < 60) {
                riskLevel = 'High Risk';
                interpretation = 'Eye exam every 3-6 months. Consider retina specialist referral. Aggressive systemic control needed.';
            } else {
                riskLevel = 'Very High Risk';
                interpretation = 'Close monitoring required (every 2-3 months). Retina specialist involvement essential. May need laser or anti-VEGF therapy.';
            }
            
            let output = `<strong>${riskLevel}</strong><br><br>`;
            output += `<strong>Recommendations:</strong><br>${interpretation}<br><br>`;
            output += `<strong>Key Modifiable Factors:</strong><br>`;
            output += `‚Ä¢ Target HbA1c: <7%<br>`;
            output += `‚Ä¢ Target BP: <140/90 mmHg<br>`;
            output += `‚Ä¢ Lipid control<br>`;
            output += `‚Ä¢ Regular follow-up`;
            
            resultInterpretation.innerHTML = output;
            resultBox.classList.add('show');
        }

        function calculateSE() {
            const sphere = parseFloat(document.getElementById('ref-sphere').value);
            const cyl = parseFloat(document.getElementById('ref-cyl').value);
            
            if (isNaN(sphere) || isNaN(cyl)) {
                alert('Please fill in both sphere and cylinder values');
                return;
            }
            
            const se = sphere + (cyl / 2);
            
            const resultBox = document.getElementById('se-result');
            const resultValue = document.getElementById('se-value');
            const resultInterpretation = document.getElementById('se-interpretation');
            
            resultValue.textContent = se.toFixed(2) + ' D';
            
            let interpretation = '';
            if (se > 0.5) {
                interpretation = '<strong>Hyperopia (Farsightedness)</strong><br>Patient may have difficulty with near vision.';
            } else if (se < -0.5) {
                interpretation = '<strong>Myopia (Nearsightedness)</strong><br>Patient may have difficulty with distance vision.';
            } else {
                interpretation = '<strong>Emmetropia (Normal)</strong><br>Minimal refractive error.';
            }
            
            interpretation += `<br><br><strong>Formula:</strong> SE = Sphere + (Cylinder √∑ 2)<br>`;
            interpretation += `SE = ${sphere.toFixed(2)} + (${cyl.toFixed(2)} √∑ 2) = ${se.toFixed(2)} D`;
            
            resultInterpretation.innerHTML = interpretation;
            resultBox.classList.add('show');
        }

        function calculateTargetIOP() {
            const baseline = parseFloat(document.getElementById('iop-baseline').value);
            const severity = document.getElementById('iop-severity').value;
            const risk = document.getElementById('iop-risk').value;
            
            if (!baseline || !severity || !risk) {
                alert('Please fill in all fields');
                return;
            }
            
            let reductionPercent = 0;
            
            // Base reduction on severity
            if (severity === 'early') reductionPercent = 20;
            else if (severity === 'moderate') reductionPercent = 30;
            else if (severity === 'advanced') reductionPercent = 40;
            
            // Adjust for risk
            if (risk === 'moderate') reductionPercent += 5;
            else if (risk === 'high') reductionPercent += 10;
            
            const targetIOP = baseline * (1 - reductionPercent / 100);
            const upperTarget = targetIOP + 2;
            const lowerTarget = Math.max(targetIOP - 2, 10); // Don't go below 10
            
            const resultBox = document.getElementById('target-iop-result');
            const resultValue = document.getElementById('target-iop-value');
            const resultInterpretation = document.getElementById('target-iop-interpretation');
            
            resultValue.textContent = `${lowerTarget.toFixed(0)} - ${upperTarget.toFixed(0)} mmHg`;
            
            let interpretation = `<strong>Target IOP Reduction:</strong> ${reductionPercent}% from baseline<br><br>`;
            interpretation += `<strong>Baseline IOP:</strong> ${baseline} mmHg<br>`;
            interpretation += `<strong>Calculated Target:</strong> ${targetIOP.toFixed(1)} mmHg<br><br>`;
            interpretation += `<strong>Guidelines:</strong><br>`;
            interpretation += `‚Ä¢ Early glaucoma: 20-25% reduction<br>`;
            interpretation += `‚Ä¢ Moderate glaucoma: 30-35% reduction<br>`;
            interpretation += `‚Ä¢ Advanced glaucoma: 40-50% reduction<br><br>`;
            
            if (reductionPercent >= 40) {
                interpretation += `<div class="warning-box"><strong>‚ö†Ô∏è Note:</strong> Achieving ${reductionPercent}% reduction may require combination therapy or surgery. Consider referral to glaucoma specialist.</div>`;
            }
            
            resultInterpretation.innerHTML = interpretation;
            resultBox.classList.add('show');
        }

        function calculateACE() {
            const age = parseFloat(document.getElementById('ace-age').value);
            const drusen = document.getElementById('ace-drusen').value;
            const pigment = document.getElementById('ace-pigment').value;
            const fellow = document.getElementById('ace-fellow').value;
            
            if (!age || !drusen || !pigment || !fellow) {
                alert('Please fill in all fields');
                return;
            }
            
            let riskScore = 0;
            
            // Age factor
            if (age >= 75) riskScore += 3;
            else if (age >= 65) riskScore += 2;
            else if (age >= 55) riskScore += 1;
            
            // Drusen factor
            if (drusen === 'large') riskScore += 3;
            else if (drusen === 'medium') riskScore += 1;
            
            // Pigment factor
            if (pigment === 'present') riskScore += 1;
            
            // Fellow eye factor
            if (fellow === 'yes') riskScore += 4;
            
            let risk5yr = 0;
            if (riskScore <= 1) risk5yr = 1;
            else if (riskScore === 2) risk5yr = 3;
            else if (riskScore === 3) risk5yr = 7;
            else if (riskScore === 4) risk5yr = 13;
            else if (riskScore === 5) risk5yr = 25;
            else if (riskScore === 6) risk5yr = 35;
            else if (riskScore === 7) risk5yr = 45;
            else risk5yr = 50;
            
            const resultBox = document.getElementById('ace-result');
            const resultValue = document.getElementById('ace-value');
            const resultInterpretation = document.getElementById('ace-interpretation');
            
            resultValue.textContent = risk5yr + '%';
            
            let interpretation = `<strong>Risk Score:</strong> ${riskScore} points<br><br>`;
            
            if (risk5yr < 5) {
                interpretation += '<strong>Low Risk</strong><br>Annual monitoring recommended.';
            } else if (risk5yr < 15) {
                interpretation += '<strong>Moderate Risk</strong><br>Consider AREDS2 supplementation. Monitor every 6-12 months.';
            } else if (risk5yr < 30) {
                interpretation += '<strong>High Risk</strong><br>AREDS2 supplementation strongly recommended. Monitor every 6 months. Home Amsler grid testing.';
            } else {
                interpretation += '<strong>Very High Risk</strong><br>AREDS2 supplementation essential. Close monitoring (every 3-6 months). Anti-VEGF therapy if CNV develops.';
            }
            
            interpretation += `<br><br><strong>AREDS2 Formulation:</strong><br>`;
            interpretation += `‚Ä¢ Vitamin C: 500 mg<br>`;
            interpretation += `‚Ä¢ Vitamin E: 400 IU<br>`;
            interpretation += `‚Ä¢ Lutein: 10 mg<br>`;
            interpretation += `‚Ä¢ Zeaxanthin: 2 mg<br>`;
            interpretation += `‚Ä¢ Zinc: 80 mg<br>`;
            interpretation += `‚Ä¢ Copper: 2 mg`;
            
            resultInterpretation.innerHTML = interpretation;
            resultBox.classList.add('show');
        }
    </script>
</body>
</html>
